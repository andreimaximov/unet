#include <gtest/gtest.h>

#include <unet/detail/check.hpp>
#include <unet/wire/wire.hpp>

namespace unet {
namespace detail {

TEST(CheckTest, ChecksumEvenLen) {
  std::uint8_t buf[] = {0x45, 0x00, 0x00, 0x73, 0x00, 0x00, 0x40,
                        0x00, 0x40, 0x11, 0x00, 0x00, 0xc0, 0xa8,
                        0x00, 0x01, 0xc0, 0xa8, 0x00, 0xc7};
  ASSERT_EQ(hostToNet<std::uint16_t>(0xB861), checksum(buf, sizeof(buf)));
}

TEST(CheckTest, ChecksumOddLen) {
  std::uint8_t buf[] = {0x45, 0x00, 0x00, 0x73, 0x00, 0x00, 0x40,
                        0x00, 0x40, 0x11, 0x00, 0x00, 0xc0, 0xa8,
                        0x00, 0x01, 0xc0, 0xa8, 0x00};
  ASSERT_EQ(hostToNet<std::uint16_t>(0xB928), checksum(buf, sizeof(buf)));
}

}  // namespace detail
}  // namespace unet
